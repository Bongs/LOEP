<div class="loep_form_wrapper new_assignment_form">
  <p class="form_before_button">&nbsp;</p>

  <%= form_for(@assignment) do |f| %>
    
    <p class="form_legend">Learning Objects</p>
    <select name="selected_los[]" multiple="true" id="select_los" class="loep_input">
      <% @los.each do |lo| %>
        <option value="<%=lo.id%>"><%=lo.name%></option>
      <% end %>
    </select>

    <p class="form_legend">Reviewers</p>
    <select name="selected_users[]" multiple="true" id="select_users" class="loep_input">
      <% @users.each do |user| %>
        <option value="<%=user.id%>"><%=user.name%></option>
      <% end %>
    </select>

    <p class="form_legend">Evaluation Methods</p>
    <%= f.select :emethods, options_for_select(@options_select["eMethods"],@assignment.getEMethods), {} ,{ :multiple => true, :size => 2, :class=>'loep_input' } %>

    <p class="form_legend">Description</p>
    <%= f.text_area :description, :class=>'loep_input' %>

    <% if !@assignment.status.nil? %>
      <p class="form_legend">Status</p>
      <%= f.select :status, options_for_select(@options_select["status"],@assignment.status || "Pending"), {} ,{ :class=>'loep_input' } %>
    <% end %>

    <% if !@assignment.completed_at.nil? %>
      <p class="form_legend">Completion Date</p>
      <%=text_field_tag "assignment[completed_at]",@assignment.readable_completed_at, :class=>'loep_input', :id=>"completed_at_datepicker" %>
    <% end %>

    <p class="form_legend">Deadline</p>
    <%=text_field_tag "assignment[deadline]",@assignment.readable_deadline, :class=>'loep_input', :id=>"deadline_datepicker" %>

    <input id="assignment_author_id" name="assignment[author_id]" type="hidden" value="<%=current_user.id%>">

    <p class="form_before_button">&nbsp;</p>
    <p class="form_before_button">&nbsp;</p>
    <%= f.submit :class => 'loep_button' %>

  <% end %>
</div>

<script type="text/javascript">
  jQuery(document).ready(function($){
    //Datetimepicker Addon: http://trentrichardson.com/examples/timepicker/#basic_examples
    $('#deadline_datepicker').datetimepicker({
      yearRange: "-1:+10",
      showOn: "both",
      dateFormat : 'dd/mm/yy',
      changeMonth : true,
      changeYear : true,
      minDate: '0d',
      buttonImage: "/assets/calendar_icon.png", 
      buttonImageOnly: true,
      timeFormat: "HH:mm tt",
      stepHour: 1,
      stepMinute: 15
    });

    if ($("#completed_at_datepicker").length > 0){
      $('#completed_at_datepicker').datetimepicker({
        yearRange: "-1:+10",
        showOn: "both",
        dateFormat : 'dd/mm/yy',
        changeMonth : true,
        changeYear : true,
        minDate: '0d',
        buttonImage: "/assets/calendar_icon.png", 
        buttonImageOnly: true,
        timeFormat: "HH:mm tt",
        stepHour: 1,
        stepMinute: 15
      });
    }

    //Little fix for select input
    $("#select_los").attr("style","width:" + $("#select_los").width() + "px");
    $("#select_los").select2();

    $("#select_users").attr("style","width:" + $("#select_users").width() + "px");
    $("#select_users").select2();

    //Add search icon
    $(".select2-container-multi").prepend($("<div class='multiselect2search'><span class='glyphicon glyphicon-search'></span></div>"));
  });
</script>